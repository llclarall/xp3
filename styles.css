:root {
    /* Palette */
    --primary: #FFD700;
    --text-dark: #2c3e50;
    --glass: rgba(255, 255, 255, 0.95);
    --glass-border: rgba(255, 255, 255, 0.5);
    
    /* Dimensions Structurelles */
    --control-height: 140px; /* Espace réservé en bas pour les mains */
    
    /* Couleurs Époques */
    --c-pre: #2c3e50; 
    --c-ant: #e67e22; 
    --c-moy: #27ae60; 
    --c-ren: #8e44ad; 
    --c-ind: #7f8c8d;
    --c-mod: #2980b9;
}

body {
    margin: 0; padding: 0; overflow: hidden; height: 100vh; width: 100vw;
    font-family: 'Fredoka', sans-serif; background: #222;
    user-select: none; touch-action: none; display: flex; flex-direction: column;
}

/* --- 1. LE MONDE (ARRIÈRE-PLAN) --- */
#game-viewport { 
    position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
    z-index: 0; overflow: hidden; 
}
#world-track { 
    display: flex; height: 100%; width: 40037.5vw; /* La plus courte époque (~80 ans) couvre ~1 écran */
    will-change: transform; transition: transform 0.1s linear; 
}
.era-slide { height: 100%; position: relative; overflow: hidden; }
/* Proportions basées sur l'époque la plus courte (Moderne ~80 ans) */
.slide-1 { flex: 337.5; } /* Préhistoire ~27 000 ans */
.slide-2 { flex: 43.75; } /* Antiquité ~3 500 ans */
.slide-3 { flex: 12.5; } /* Moyen-Âge ~1 000 ans */
.slide-4 { flex: 3.75; } /* Renaissance ~300 ans */
.slide-5 { flex: 1.875; } /* Révolution Industrielle ~150 ans */
.slide-6 { flex: 1; } /* Moderne ~80 ans (référence) */

/* --- DÉCORS (GARDÉS DE LA VERSION PRÉCÉDENTE) --- */
.slide-1 { background: linear-gradient(to bottom, #0f2027, #203a43, #2c5364); }
.slide-2 { background: linear-gradient(to bottom, #FF8008, #FFC837); }
.slide-3 { background: linear-gradient(to bottom, #2980B9, #6DD5FA); }
.slide-4 { background: linear-gradient(to bottom, #654ea3, #eaafc8); }
.slide-5 { background: linear-gradient(to bottom, #434343, #000000); }
.slide-6 { background: linear-gradient(to bottom, #141E30, #243B55); }

/* Éléments CSS Art */
.mountain { position: absolute; bottom: var(--control-height); left: 0; width: 100%; height: 50%; background: #141E30; clip-path: polygon(0% 100%, 15% 30%, 30% 80%, 45% 40%, 60% 90%, 75% 20%, 90% 60%, 100% 100%); opacity: 0.8; }
.cave { position: absolute; bottom: var(--control-height); left: 10%; width: 250px; height: 180px; background: #080808; border-radius: 50% 50% 0 0; box-shadow: inset 0 20px 40px rgba(0,0,0,0.8); border: 2px solid rgba(255,255,255,0.1); }
.dunes { position: absolute; bottom: var(--control-height); left: 0; width: 120%; height: 40%; background: #e67e22; border-radius: 100% 100% 0 0; transform: translateX(-10%); }
.hills { position: absolute; bottom: var(--control-height); left: -10%; width: 120%; height: 45%; background: #27ae60; border-radius: 50% 50% 0 0; }
.city { position: absolute; bottom: var(--control-height); left: 0; width: 100%; height: 35%; background: linear-gradient(#34495e, #34495e) 5% 100% / 8% 60% no-repeat, linear-gradient(#2c3e50, #2c3e50) 20% 100% / 10% 80% no-repeat, linear-gradient(#34495e, #34495e) 40% 100% / 12% 50% no-repeat, linear-gradient(#2c3e50, #2c3e50) 80% 100% / 10% 70% no-repeat; opacity: 0.8; }

.bg-stars { position: absolute; top:0; left:0; width:100%; height:80%; background-image: radial-gradient(white 2px, transparent 2px); background-size: 60px 60px; opacity: 0.6; }
.sun { position: absolute; top: 15%; right: 20%; width: 15vh; height: 15vh; background: #FFF; border-radius: 50%; box-shadow: 0 0 60px #FFD54F; }

/* Éléments répétitifs pour montrer le mouvement */
.repeat-decor {
    position: absolute;
    bottom: calc(var(--control-height) + 150px);
    font-size: 8vh;
    opacity: 0.6;
    filter: drop-shadow(0 5px 5px rgba(0,0,0,0.3));
}

/* Lignes au sol pour montrer le défilement */
.ground::before {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: repeating-linear-gradient(
        90deg,
        transparent,
        transparent 15vw,
        rgba(255, 255, 255, 0.594) 15vw,
        rgba(255, 255, 255, 0.443) 15.5vw
    );
    pointer-events: none;
}

/* --- OBJETS & HOTSPOTS --- */
.prop-group { 
    position: absolute; 
    bottom: calc(var(--control-height) + 70px); /* Bien au dessus du sol */
    z-index: 100; 
}
.prop-emoji { font-size: 15vh; filter: drop-shadow(0 10px 10px rgba(0,0,0,0.3)); }

.hotspot-btn {
    position: absolute; top: 20px; right: -30px;
    width: 44px; height: 44px; background: white;
    border-radius: 50%; border: 4px solid var(--primary);
    color: var(--text-dark); font-weight: bold; font-size: 24px;
    display: flex; justify-content: center; align-items: center;
    cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    animation: pulseBtn 2s infinite;
}
.info-bubble {
    position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%) scale(0);
    width: 240px; background: white; padding: 15px; border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4); text-align: center;
    font-size: 18px; color: #333; pointer-events: none; opacity: 0;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 100;
}
.info-bubble.active { transform: translateX(-50%) scale(1); opacity: 1; pointer-events: auto; }
.info-bubble::after { content:''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); border-width: 10px 10px 0; border-style: solid; border-color: white transparent transparent; }

/* --- SOL & FRISE (HIÉRARCHISÉS) --- */
.ground { 
    position: absolute; 
    bottom: calc(var(--control-height) + 20px); /* Le sol commence AU-DESSUS des contrôles */
    width: 100%; height: 100px; 
    border-bottom: 4px solid rgba(255,255,255,0.4); 
    z-index: 20;
}
.timeline-markers { position: absolute; bottom: -20px; left: 0; width: 100%; height: 100%; }

.marker-main { 
    position: absolute; bottom: 30px; left: 20px;
    background: #2D3436; color: white; padding: 8px 20px; 
    border-radius: 12px; font-size: 2.2vh; font-weight: 900; 
    border: 2px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

.marker-sub { 
    position: absolute; bottom: 0; height: 40px; 
    border-left: 3px solid rgba(255,255,255,0.6); 
    display: flex; flex-direction: column; align-items: center; 
}
.marker-sub span { 
    margin-top: -35px; background: rgba(255,255,255,0.9); color: #333; 
    padding: 3px 8px; border-radius: 5px; font-weight: bold; font-size: 1.5vh; 
    white-space: nowrap; 
}

.era-watermark { 
    position: absolute; top: 10px; right: 50%; transform: translateX(50%); 
    font-size: 6vw; font-weight: 900; color: rgba(255, 255, 255, 0.54); 
    text-transform: uppercase; letter-spacing: 10px; pointer-events: none; 
    width: 90%; text-align: center;  
}

/* --- UI HAUTE (MISSION) --- */
.top-hud {
    position: absolute; top: 30px; left: 30px;
    z-index: 100;
}
.mission-bubble {
    background: var(--glass); backdrop-filter: blur(10px);
    border: 3px solid white; border-radius: 20px;
    padding: 15px 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}
.m-title { font-size: 14px; text-transform: uppercase; color: #666; font-weight: bold; margin-bottom: 5px; }
.m-content { font-size: 24px; color: var(--text-dark); font-weight: 800; }

/* --- ERA INDICATOR --- */
.era-indicator { 
    position: fixed; top: 30px; right: 30px; font-size: 4.2vw; z-index: 95; font-weight: 900; color: rgba(255, 255, 255, 0.54);text-transform: uppercase; letter-spacing: 10px; pointer-events: none; 
}

/* --- UI BASSE (CONTROLS - ZONE MAINS) --- */
.top-nav {
    position: absolute; top: 300px; left: 0; width: 100%;
    padding: 0 30px; box-sizing: border-box; z-index: 110;
}

.bottom-hud {
    position: absolute; left: 200px; top: 290px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    z-index: 100;
}

.era-button {
    width: 180px;
    height: 65px;
    border-radius: 18px;
    border: none;
    box-shadow: 0 6px 20px rgba(0,0,0,0.3), inset 0 2px 0 rgba(255,255,255,0.3);
    cursor: pointer;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    color: white;
    font-weight: 900;
    font-size: 13px;
    text-transform: uppercase;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    padding: 12px 18px;
    gap: 15px;
    position: relative;
    overflow: hidden;
    letter-spacing: 0.5px;
}

/* Effet de brillance */
.era-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    transition: left 0.5s;
}

.era-button:hover::before {
    left: 100%;
}

.era-button:hover {
    transform: translateX(15px) scale(1.05);
    box-shadow: 0 10px 30px rgba(0,0,0,0.5), inset 0 2px 0 rgba(255,255,255,0.4);
}

.era-button:active {
    transform: translateX(10px) scale(1.02);
    box-shadow: 0 4px 15px rgba(0,0,0,0.4), inset 0 2px 0 rgba(255,255,255,0.2);
}

.era-button .era-emoji {
    font-size: 28px;
    flex-shrink: 0;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    transition: transform 0.3s;
}

.era-button:hover .era-emoji {
    transform: scale(1.2) rotate(5deg);
}

.era-button .era-label {
    font-size: 12px;
    text-align: left;
    line-height: 1.3;
    flex: 1;
    text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.btn-pre { background: var(--c-pre); }
.btn-ant { background: var(--c-ant); }
.btn-moy { background: var(--c-moy); }
.btn-ren { background: var(--c-ren); }
.btn-ind { background: var(--c-ind); }
.btn-mod { background: var(--c-mod); }

/* --- FRISE STATIQUE À L'ÉCHELLE --- */
.static-scale { position: absolute; left: 30px; right: 30px; top: 150px; z-index: 120; pointer-events: none; }
.scale-card { background: rgba(0,0,0,0.6); border: 2px solid rgba(255,255,255,0.25); border-radius: 18px; padding: 10px 14px; box-shadow: 0 15px 35px rgba(0,0,0,0.35); }
.scale-title { color: white; font-weight: 900; font-size: 14px; letter-spacing: 1px; margin-bottom: 8px; text-transform: uppercase; opacity: 0.85; }
.scale-bar { position: relative; display: flex; height: 44px; border-radius: 12px; overflow: hidden; border: 2px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.08); box-sizing: border-box; }
.scale-seg { position: relative; display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; text-align: center; gap: 2px; padding: 0; min-width: 0; }
.scale-seg span { font-weight: 800; font-size: 12px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); white-space: nowrap; }
.scale-seg small { font-size: 10px; opacity: 0.85; white-space: nowrap; }
.scale-pre { background: var(--c-pre); }
.scale-ant { background: var(--c-ant); }
.scale-moy { background: var(--c-moy); }
.scale-ren { background: var(--c-ren); }
.scale-ind { background: var(--c-ind); }
.scale-mod { background: var(--c-mod); }
.scale-pointer { position: absolute; top: -8px; width: 3px; height: 60px; background: white; box-shadow: 0 0 0 3px rgba(255,255,255,0.2); border-radius: 2px; pointer-events: none; transition: left 0.1s linear; }
.scale-pointer-label { position: absolute; top: -22px; left: 50%; transform: translateX(-50%); background: white; color: #2c3e50; padding: 2px 6px; border-radius: 8px; font-weight: 800; font-size: 11px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); white-space: nowrap; }
.scale-cursor { position: absolute; top: 50%; left: 0%; transform: translateX(-50%) translateY(-50%); font-size: 26px; pointer-events: none; transition: left 0.1s linear; filter: drop-shadow(0 3px 6px rgba(0,0,0,0.4)); z-index: 10; }
.scale-legend { display: flex; justify-content: space-between; color: rgba(255,255,255,0.85); font-size: 11px; margin-top: 6px; }
.scale-note { color: rgba(255,255,255,0.65); font-size: 11px; margin-top: 4px; }

/* Vignettes de personnages sur la frise */
.character-marker {
    position: absolute;
    bottom: -5px;
    width: 40px;
    height: 40px;
    background: white;
    border: 3px solid var(--primary);
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    transform: translateX(-50%);
    z-index: 15;
    animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
.character-marker img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
}
@keyframes popIn {
    0% { transform: translateX(-50%) scale(0); opacity: 0; }
    100% { transform: translateX(-50%) scale(1); opacity: 1; }
}



/* Le Dock du Personnage */
.char-dock {
    position: absolute;
    top: 300px;
    left: 50%;
    transform: translateX(-50%);
    width: 170px; height: 170px;
    background: rgba(255,255,255,0.3); backdrop-filter: blur(5px);
    border-radius: 50%; border: 3px dashed rgba(255,255,255,0.6);
    display: flex; justify-content: center; align-items: center;
    z-index: 100;
}
.liko-token {
    width: 170px; height: 170px; background: var(--primary);
    border: 5px solid white; border-radius: 50%;
    display: flex; justify-content: center; align-items: center;
    font-size: 60px; cursor: grab;
    box-shadow: 0 10px 20px rgba(0,0,0,0.4);
    animation: bounce 3s infinite;
}
.liko-token:active { animation: none; transform: scale(0.9); cursor: grabbing; }

.liko-img { width: 100%; height: 100%; object-fit: contain; max-width: 250px; }

/* --- FEEDBACK --- */
#ghost { position: fixed; font-size: 90px; opacity: 0; pointer-events: none; z-index: 9999; }

.arrow-hint { position: absolute; top: 50%; transform: translateY(-50%); width: 100px; height: 100px; background: #FF4757; color: white; border-radius: 50%; font-size: 50px; display: none; justify-content: center; align-items: center; box-shadow: 0 10px 30px rgba(0,0,0,0.4); border: 5px solid white; animation: pulseBtn 1s infinite; z-index: 500; }
#arrow-left { left: 50px; } #arrow-right { right: 50px; }

#liko-landed { position: absolute; bottom: 200px; right: 15%; font-size: 18vh; display: none; filter: drop-shadow(0 10px 5px rgba(0,0,0,0.4)); animation: bounceDrop 0.8s ease-out; z-index: 5; }

/* --- POLAROID --- */
.polaroid-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.85); z-index: 2000;
    display: none; justify-content: center; align-items: center;
    backdrop-filter: blur(10px); opacity: 0; transition: opacity 0.5s;
}
.polaroid {
    background: white; padding: 20px 20px 80px 20px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.5); transform: rotate(-3deg) scale(0.8);
    text-align: center; transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
}
.polaroid-img {
    width: 450px; height: 350px; background: #333; overflow: hidden; position: relative;
    display: flex; justify-content: center; align-items: center;
}

.polaroid-img img {
    width: 250px; height: 250px; object-fit: contain; vertical-align: middle;
}

.polaroid-caption {
    position: absolute; bottom: 25px; width: 100%; left: 0;
    font-family: 'Courier New', monospace; font-weight: bold; font-size: 28px; color: #333;
}
.tape { position: absolute; top: -25px; left: 50%; transform: translateX(-50%); width: 180px; height: 50px; background: rgba(255,255,255,0.6); box-shadow: 0 2px 5px rgba(0,0,0,0.1); transform: rotate(2deg); }

/* ANIMATIONS */
@keyframes pulseBtn { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
@keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
@keyframes bounceDrop { 0% { transform: translateY(-50px); opacity:0; } 60% { transform: translateY(10px); opacity:1; } 100% { transform: translateY(0); } }
@keyframes flicker { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(1.1); opacity: 0.8; } }

