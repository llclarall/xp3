<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>XP3 Timeline - Wall Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --glass: rgba(255, 255, 255, 0.95);
            --shadow-hard: 0 10px 0 rgba(0,0,0,0.2); /* Ombres dures pour mieux ressortir au projecteur */
            --text-dark: #2c3e50;
            --primary: #FFD700;
            --touch-target: 80px; /* Taille min pour un doigt d'enfant */
        }

        body {
            margin: 0; overflow: hidden; height: 100vh; width: 100vw;
            font-family: 'Fredoka', sans-serif; /* Police tr√®s ronde et lisible de loin */
            background: #2c3e50;
            user-select: none; touch-action: none;
        }

        /* --- 1. LE MONDE (ARRI√àRE-PLAN G√âANT) --- */
        #viewport { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: 0; }
        #world { display: flex; height: 100%; width: 400%; transition: transform 0.3s cubic-bezier(0.25, 1, 0.5, 1); will-change: transform; }
        
        /* Couleurs satur√©es pour contrer la d√©lavure du projecteur */
        .slide { flex: 1; height: 100%; position: relative; overflow: hidden; border-right: 2px solid rgba(255,255,255,0.1); }
        .s1 { background: linear-gradient(to bottom, #303F9F, #7B1FA2); } /* Pr√©histoire contrast√©e */
        .s2 { background: linear-gradient(to bottom, #FBC02D, #F57F17); } /* Antiquit√© vive */
        .s3 { background: linear-gradient(to bottom, #0288D1, #689F38); } /* Moyen-√Çge */
        .s4 { background: linear-gradient(to bottom, #CFD8DC, #90A4AE); } /* Moderne */

        /* Props G√âANTS (Doivent √™tre visibles du fond de la classe) */
        .prop { 
            position: absolute; bottom: 35%; /* Remont√© pour ne pas √™tre cach√© par les t√™tes */
            font-size: 15vh; 
            filter: drop-shadow(0 10px 0 rgba(0,0,0,0.3));
            transition: transform 0.2s;
        }
        
        /* Sol rehauss√© */
        .ground { 
            position: absolute; bottom: 0; width: 100%; height: 30%; 
            background: rgba(255,255,255,0.1); 
            border-top: 4px solid rgba(255,255,255,0.5);
        }
        
        /* Dates XXL */
        .big-date {
            position: absolute; top: -30px; left: 40px;
            font-size: 4vh; color: white; background: #333;
            padding: 10px 30px; border-radius: 20px;
            box-shadow: 5px 5px 0 rgba(0,0,0,0.3);
        }

        /* --- 2. INTERFACE DE COMMANDE (EN BAS) --- */
        /* Tout est regroup√© en bas pour l'accessibilit√© des enfants */
        .control-deck {
            position: absolute; bottom: 20px; left: 0; width: 100%;
            height: auto;
            display: flex; flex-direction: column; align-items: center; justify-content: flex-end;
            z-index: 100; pointer-events: none;
        }

        /* Barre de Nav (Style Arcade) */
        .nav-bar {
            pointer-events: auto;
            width: 90%; height: 80px;
            background: white; border-radius: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            display: flex; padding: 10px; margin-bottom: 20px;
            border: 4px solid #333;
        }
        
        .track { flex: 1; background: #eee; border-radius: 30px; position: relative; display: flex; overflow: hidden; }
        .zone-col { flex: 1; height: 100%; border-right: 2px solid white; opacity: 0.6; transition: 0.2s; }
        .zone-col:active { opacity: 1; background: white; }

        .handle {
            position: absolute; left: 0; top: 0; height: 100%; width: 25%;
            background: transparent; border: 6px solid #333; border-radius: 30px;
            box-sizing: border-box; box-shadow: 0 0 0 2000px rgba(255,255,255,0.6);
            display: flex; justify-content: center; align-items: center;
        }
        .grip-icon { font-size: 30px; color: #333; }

        /* MISSION DOCK (Flottant au-dessus de la nav, accessible) */
        .mission-dock {
            pointer-events: auto;
            background: var(--glass);
            padding: 15px 40px; border-radius: 30px;
            border: 4px solid #333;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            display: flex; align-items: center; gap: 30px;
            margin-bottom: 20px; /* Espace avec la nav */
            transform: translateY(0); transition: transform 0.3s;
        }
        
        .mission-text {
            font-size: 24px; font-weight: 700; color: #333;
            text-transform: uppercase; letter-spacing: 1px;
        }

        /* LIKO (Le Token √† Drag) - Version XXL */
        .liko-token {
            width: 100px; height: 100px; /* Tr√®s gros pour les mains */
            background: var(--primary);
            border-radius: 50%; border: 6px solid white;
            display: flex; justify-content: center; align-items: center;
            font-size: 60px;
            cursor: grab;
            box-shadow: 0 10px 10px rgba(0,0,0,0.2);
            animation: bounce 2s infinite;
        }
        .liko-token:active { transform: scale(1.2); cursor: grabbing; animation: none; }

        /* --- 3. UI PASSIVE (EN HAUT - HORS DE PORT√âE) --- */
        .top-display {
            position: absolute; top: 30px; width: 100%; text-align: center;
            pointer-events: none; z-index: 50;
        }
        .era-title {
            font-size: 8vh; font-weight: 900; color: rgba(255,255,255,0.3);
            text-transform: uppercase; letter-spacing: 10px;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
        }

        /* --- 4. ZONES DE NAVIGATION LAT√âRALES (TAP ZONES) --- */
        /* Permet aux enfants sur les c√¥t√©s de faire d√©filer sans toucher la barre centrale */
        .side-tap {
            position: absolute; top: 0; bottom: 150px; width: 100px;
            z-index: 90; display: flex; align-items: center; justify-content: center;
            font-size: 60px; color: white; opacity: 0; transition: opacity 0.3s;
            background: linear-gradient(to right, rgba(0,0,0,0.3), transparent);
        }
        .side-tap:active { opacity: 1; }
        .tap-left { left: 0; }
        .tap-right { right: 0; background: linear-gradient(to left, rgba(0,0,0,0.3), transparent); }

        /* --- FEEDBACK --- */
        #ghost { position: fixed; font-size: 100px; pointer-events: none; z-index: 9999; opacity: 0; }
        
        .victory-splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 2000;
            display: none; flex-direction: column; justify-content: center; align-items: center;
        }
        .victory-content { 
            text-align: center; color: white; transform: scale(0.5); 
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes pop { 0% { transform: scale(0); } 100% { transform: scale(1); } }

    </style>
</head>
<body>

    <div class="side-tap tap-left" onclick="stepMove(-1)">‚ùÆ</div>
    <div class="side-tap tap-right" onclick="stepMove(1)">‚ùØ</div>

    <div id="viewport">
        <div id="world">
            
            <div class="slide s1">
                <div class="top-display"><div class="era-title">Pr√©histoire</div></div>
                <div class="prop" style="left: 10%">üåã</div>
                <div class="prop fire-target" style="left: 50%">üî•</div> <div class="ground">
                    <div class="big-date">-400 000</div>
                </div>
            </div>

            <div class="slide s2">
                <div class="top-display"><div class="era-title">Antiquit√©</div></div>
                <div class="prop" style="left: 30%">üê™</div>
                <div class="prop" style="left: 70%">üèõÔ∏è</div>
                <div class="ground"><div class="big-date">-3 000</div></div>
            </div>

            <div class="slide s3">
                <div class="top-display"><div class="era-title">Moyen-√Çge</div></div>
                <div class="prop" style="left: 40%">üè∞</div>
                <div class="ground"><div class="big-date">476</div></div>
            </div>

            <div class="slide s4">
                <div class="top-display"><div class="era-title">Moderne</div></div>
                <div class="prop" style="left: 20%">üè≠</div>
                <div class="prop" style="left: 80%">üöÄ</div>
                <div class="ground"><div class="big-date">1789</div></div>
            </div>

        </div>
        
        <div id="liko-landed" style="position: absolute; bottom: 35%; left: 0; font-size: 15vh; display: none; filter: drop-shadow(0 10px 0 rgba(0,0,0,0.4)); animation: pop 0.5s;">üë¶</div>
    </div>

    <div class="control-deck">
        
        <div class="mission-dock" id="mission-ui">
            <div class="liko-token" id="liko-source">üë¶</div>
            <div class="mission-text">Trouve le feu !</div>
        </div>

        <div class="nav-bar">
            <div class="track" id="nav-track">
                <div class="zone-col" style="background:#303F9F" onclick="jumpTo(0)"></div>
                <div class="zone-col" style="background:#FBC02D" onclick="jumpTo(33)"></div>
                <div class="zone-col" style="background:#689F38" onclick="jumpTo(66)"></div>
                <div class="zone-col" style="background:#90A4AE" onclick="jumpTo(100)"></div>
                
                <div class="handle" id="handle">
                    <div class="grip-icon">‚Üî</div>
                </div>
            </div>
        </div>
    </div>

    <div class="victory-splash" id="victory">
        <div class="victory-content">
            <div style="font-size: 150px;">üéâüî•</div>
            <h1 style="font-size: 80px; margin: 20px 0;">BRAVO !</h1>
            <p style="font-size: 40px;">Tu as trouv√© l'√©poque du feu.</p>
            <button onclick="location.reload()" style="font-size: 40px; padding: 20px 60px; border-radius: 50px; border:none; margin-top:40px; background:#FFD700; color:#333; box-shadow: 0 10px 0 #F57F17;">Rejouer</button>
        </div>
    </div>

    <div id="ghost">üë¶</div>

    <script>
        const world = document.getElementById('world');
        const handle = document.getElementById('handle');
        const track = document.getElementById('nav-track');
        const liko = document.getElementById('liko-source');
        const ghost = document.getElementById('ghost');
        const missionUI = document.getElementById('mission-ui');
        
        let scrollPct = 0;
        let isDragging = false;
        let isLikoDrag = false;

        // --- NAVIGATION ROBUSTE ---
        function updateView() {
            // Clamp 0-100
            scrollPct = Math.max(0, Math.min(100, scrollPct));
            
            // Handle bouge de 0% √† 75% (car width 25%)
            const visualHandle = scrollPct * 0.75; 
            handle.style.left = visualHandle + '%';
            
            // World bouge de 0 √† -300vw (pour 4 slides)
            // 100% scroll = fin du slide 4
            // Slide 1 = 0-25%, Slide 2 = 25-50%...
            // Total translation max = 300vw
            const worldMove = -(scrollPct / 100) * 300;
            world.style.transform = `translateX(${worldMove}vw)`;
        }

        // Tap sur les zones color√©es
        window.jumpTo = (pct) => {
            scrollPct = pct;
            updateView();
        }

        // Tap lat√©raux
        window.stepMove = (dir) => {
            scrollPct += (dir * 25); // Saute d'une √©poque (approx)
            updateView();
        }

        // Drag du Handle
        function onNavDrag(e) {
            if(!isDragging) return;
            e.preventDefault();
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const rect = track.getBoundingClientRect();
            
            // Calcul position relative
            let x = clientX - rect.left - (rect.width * 0.125); // Centre
            let pct = (x / rect.width) * 100;
            
            // Scale pour couvrir 0-100 sur la zone navigable
            scrollPct = (pct / 0.75); 
            updateView();
        }

        handle.addEventListener('mousedown', () => isDragging = true);
        handle.addEventListener('touchstart', () => isDragging = true);
        window.addEventListener('mouseup', () => isDragging = false);
        window.addEventListener('touchend', () => isDragging = false);
        window.addEventListener('mousemove', onNavDrag);
        window.addEventListener('touchmove', onNavDrag, {passive: false});

        // --- DRAG LIKO (G√âANT) ---
        function onLikoMove(e) {
            if(!isLikoDrag) return;
            e.preventDefault();
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            
            // Ghost suit le doigt
            ghost.style.left = (clientX - 50) + 'px';
            ghost.style.top = (clientY - 50) + 'px';
        }

        function startLiko(e) {
            e.preventDefault();
            isLikoDrag = true;
            ghost.style.opacity = 1;
            liko.style.opacity = 0;
            onLikoMove(e);
        }

        function endLiko(e) {
            if(!isLikoDrag) return;
            isLikoDrag = false;
            ghost.style.opacity = 0;
            
            // Victoire : Si on est dans le premier quart (Pr√©histoire)
            // ScrollPct < 25 (environ)
            if(scrollPct < 20) {
                // VICTOIRE
                missionUI.style.transform = "translateY(200%)"; // Cache l'UI vers le bas
                const landed = document.getElementById('liko-landed');
                landed.style.display = 'block';
                landed.style.left = '50vw'; // Au milieu de l'√©cran visible ? 
                // Pour simplifier sur mur, on le met au centre absolu du slide 1
                // Mais comme le world a boug√©, il faut ajuster.
                // Ici pour la d√©mo, on affiche l'√©cran de victoire direct.
                
                setTimeout(() => {
                    const vic = document.getElementById('victory');
                    vic.style.display = 'flex';
                    setTimeout(() => vic.querySelector('.victory-content').style.transform = "scale(1)", 50);
                }, 500);

            } else {
                // RETOUR
                liko.style.opacity = 1;
                // Feedback visuel "Non"
                world.style.transform += "translateX(10px)";
                setTimeout(() => updateView(), 100);
            }
        }

        liko.addEventListener('mousedown', startLiko);
        liko.addEventListener('touchstart', startLiko);
        window.addEventListener('mousemove', onLikoMove);
        window.addEventListener('touchmove', onLikoMove, {passive:false});
        window.addEventListener('mouseup', endLiko);
        window.addEventListener('touchend', endLiko);

    </script>
</body>
</html>